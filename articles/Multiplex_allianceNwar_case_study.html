<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stochastic Block Models for Multiplex networks • sbm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Stochastic Block Models for Multiplex networks">
<meta property="og:description" content="sbm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sbm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SBM_fungus_tree_network.html">Fungus-tree interaction with simple and bipartite SBM</a>
    </li>
    <li>
      <a href="../articles/Multipartite_EcologicalNetwork.html">Mutualistic ecological network with multipartite SBM</a>
    </li>
    <li>
      <a href="../articles/MultiplexNetwork_principle.html">Multiplex SBM: Principle and illustration</a>
    </li>
    <li>
      <a href="../articles/Multiplex_allianceNwar_case_study.html">Multiplex SBM: War and Alliance case study</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/GrossSBM/GSBM" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stochastic Block Models for Multiplex
networks</h1>
            <h3 data-toc-skip class="subtitle">War and Alliance case
study</h3>
                        <h4 data-toc-skip class="author">team
großBM</h4>
            
            <h4 data-toc-skip class="date">2024-01-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/GrossSBM/sbm/blob/HEAD/vignettes/Multiplex_allianceNwar_case_study.Rmd" class="external-link"><code>vignettes/Multiplex_allianceNwar_case_study.Rmd</code></a></small>
      <div class="hidden name"><code>Multiplex_allianceNwar_case_study.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="preliminaries">Preliminaries<a class="anchor" aria-label="anchor" href="#preliminaries"></a>
</h3>
<p>This vignette illustrates the use of the
<code>estimateMultiplexSBM</code> function and the methods accompanying
the R6 classes <code>multiplexSBMfit</code> on the <code>war</code> data
set.</p>
<div class="section level4">
<h4 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h4>
<p>The packages required for the analysis are <strong>sbm</strong> plus
some others for data manipulation and representation:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://grosssbm.github.io/sbm/" class="external-link">sbm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.igraph.org/" class="external-link">igraph</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jchiquet/aricode" class="external-link">aricode</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="data-set">Data set<a class="anchor" aria-label="anchor" href="#data-set"></a>
</h4>
<p>The <code>war</code> data set comes in the <code>sbm</code>
package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"war"</span><span class="op">)</span></span></code></pre></div>
<p>This data set contains a list of two networks
(<code>belligerent</code> and <code>alliance</code>) where the nodes are
countries; an edge in the network <code>belligerent</code> means that
the two countries have been at war at least once between years 1816 to
2007; an edge in network <code>alliance</code> means that the two
countries have had a formal alliance between years 1816 and 2012. The
network <code>belligerent</code> have less nodes since countries which
have not been at war at all are not considered.</p>
<p>These two networks were extracted from <a href="https://correlatesofwar.org/" class="external-link">https://correlatesofwar.org/</a>
(see <span class="citation">Sarkees and Wayman (<a href="#ref-sarkees2010resort" role="doc-biblioref">2010</a>)</span> for
war data, and <span class="citation">Gibler (<a href="#ref-gibler2008international" role="doc-biblioref">2008</a>)</span> for formal alliance). Version 4.0
was used for war data and version 4.1 for formal alliance.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-manipulation">Data manipulation<a class="anchor" aria-label="anchor" href="#data-manipulation"></a>
</h2>
<p>Since they don’t have the same size, we choose to only consider nodes
(countries) which were at war with at least one other country. This
corresponds to the first 83 nodes in the Alliance network.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/get.adjacency.html" class="external-link">get.adjacency</a></span><span class="op">(</span><span class="va">war</span><span class="op">$</span><span class="va">alliance</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: `get.adjacency()` was deprecated in igraph 2.0.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `as_adjacency_matrix()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; This graph was created by an old(er) igraph version.</span></span>
<span><span class="co">#&gt;   Call upgrade_graph() on it to use with the current igraph version</span></span>
<span><span class="co">#&gt;   For now we convert it on the fly...</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span> <span class="va">A</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">83</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">83</span><span class="op">]</span></span>
<span><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://r.igraph.org/reference/get.adjacency.html" class="external-link">get.adjacency</a></span><span class="op">(</span><span class="va">war</span><span class="op">$</span><span class="va">belligerent</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; This graph was created by an old(er) igraph version.</span></span>
<span><span class="co">#&gt;   Call upgrade_graph() on it to use with the current igraph version</span></span>
<span><span class="co">#&gt;   For now we convert it on the fly...</span></span></code></pre></div>
<p>We can start with a plot of this multiplex network:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">netA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineSBM.html">defineSBM</a></span><span class="op">(</span><span class="va">A</span>, model <span class="op">=</span> <span class="st">"bernoulli"</span>, dimLabels <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span>
<span><span class="va">netB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defineSBM.html">defineSBM</a></span><span class="op">(</span><span class="va">B</span>, model <span class="op">=</span> <span class="st">"bernoulli"</span>, dimLabels <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotMyMultiplexMatrix.html">plotMyMultiplexMatrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">netA</span>, <span class="va">netB</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multiplex_allianceNwar_case_study_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="fitting-a-multiplex-sbm-model-where-the-two-layers-are-assumed-to-be-independent">Fitting a multiplex SBM model where the two layers are assumed to be
independent<a class="anchor" aria-label="anchor" href="#fitting-a-multiplex-sbm-model-where-the-two-layers-are-assumed-to-be-independent"></a>
</h2>
<p>We run the estimation of this multiplex model. By setting
<code>dependent=FALSE</code>, we declare that we consider the two layers
to be independent conditionally on the latent block variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MultiplexFitIndep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateMultiplexSBM.html">estimateMultiplexSBM</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">netA</span>, <span class="va">netB</span><span class="op">)</span>, dependent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    estimOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbosity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can retrieve the clustering</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clust_country_indep</span> <span class="op">&lt;-</span> <span class="va">MultiplexFitIndep</span><span class="op">$</span><span class="va">memberships</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">clust_country_indep</span><span class="op">)</span></span>
<span><span class="co">#&gt;       United States of America                         Canada </span></span>
<span><span class="co">#&gt;                              1                              1 </span></span>
<span><span class="co">#&gt;                         Belize                    El Salvador </span></span>
<span><span class="co">#&gt;                              2                              2 </span></span>
<span><span class="co">#&gt;                       Colombia                        Ecuador </span></span>
<span><span class="co">#&gt;                              2                              2 </span></span>
<span><span class="co">#&gt;                        Bolivia                        Uruguay </span></span>
<span><span class="co">#&gt;                              2                              2 </span></span>
<span><span class="co">#&gt;                        Bahamas                           Cuba </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                          Haiti             Dominican Republic </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                        Jamaica            Trinidad and Tobago </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                       Barbados                       Dominica </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                        Grenada                      St. Lucia </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt; St. Vincent and the Grenadines              Antigua &amp; Barbuda </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;            St. Kitts and Nevis                         Mexico </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                      Guatemala                       Honduras </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                      Nicaragua                     Costa Rica </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                         Panama                      Venezuela </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                         Guyana                       Suriname </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                           Peru                         Brazil </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                       Paraguay                          Chile </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                      Argentina                 United Kingdom </span></span>
<span><span class="co">#&gt;                              3                              4 </span></span>
<span><span class="co">#&gt;                    Netherlands                        Belgium </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                     Luxembourg                         France </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                          Spain                       Portugal </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                        Germany        German Federal Republic </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                         Poland                        Hungary </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                 Czech Republic                          Italy </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                         Greece                         Norway </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                        Denmark                        Iceland </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                        Bavaria     German Democratic Republic </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                          Baden                   Wuerttemburg </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                Austria-Hungary                        Austria </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                 Czechoslovakia                       Slovakia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                          Malta                        Albania </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Croatia                     Yugoslavia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;         Bosnia and Herzegovina                         Cyprus </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                       Bulgaria                        Moldova </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Romania                         Russia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Estonia                         Latvia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                      Lithuania                        Ukraine </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Belarus                        Armenia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Georgia                     Azerbaijan </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Finland                         Sweden </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                     Cape Verde          Sao Tome and Principe </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                  Guinea-Bissau </span></span>
<span><span class="co">#&gt;                              5</span></span></code></pre></div>
<p>And we can plot the reorganized adjacency matrices or the
corresponding expectations:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MultiplexFitIndep</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multiplex_allianceNwar_case_study_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MultiplexFitIndep</span>, type <span class="op">=</span> <span class="st">"expected"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multiplex_allianceNwar_case_study_files/figure-html/unnamed-chunk-6-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="fitting-a-multiplex-sbm-model-where-the-two-layers-are-assumed-to-be-dependent">Fitting a multiplex SBM model where the two layers are assumed to be
dependent<a class="anchor" aria-label="anchor" href="#fitting-a-multiplex-sbm-model-where-the-two-layers-are-assumed-to-be-dependent"></a>
</h2>
<p>Now we assume that the two layers are dependent conditionally to the
latent block variables. We then set <code>dependent = TRUE</code></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MultiplexFitdep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimateMultiplexSBM.html">estimateMultiplexSBM</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">netA</span>, <span class="va">netB</span><span class="op">)</span>, dependent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    estimOptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>verbosity <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can retrieve the clustering and compare it to the one obtained in
the independent case.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clust_country_dep</span> <span class="op">&lt;-</span> <span class="va">MultiplexFitdep</span><span class="op">$</span><span class="va">memberships</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">clust_country_indep</span><span class="op">)</span></span>
<span><span class="co">#&gt;       United States of America                         Canada </span></span>
<span><span class="co">#&gt;                              1                              1 </span></span>
<span><span class="co">#&gt;                         Belize                    El Salvador </span></span>
<span><span class="co">#&gt;                              2                              2 </span></span>
<span><span class="co">#&gt;                       Colombia                        Ecuador </span></span>
<span><span class="co">#&gt;                              2                              2 </span></span>
<span><span class="co">#&gt;                        Bolivia                        Uruguay </span></span>
<span><span class="co">#&gt;                              2                              2 </span></span>
<span><span class="co">#&gt;                        Bahamas                           Cuba </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                          Haiti             Dominican Republic </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                        Jamaica            Trinidad and Tobago </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                       Barbados                       Dominica </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                        Grenada                      St. Lucia </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt; St. Vincent and the Grenadines              Antigua &amp; Barbuda </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;            St. Kitts and Nevis                         Mexico </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                      Guatemala                       Honduras </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                      Nicaragua                     Costa Rica </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                         Panama                      Venezuela </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                         Guyana                       Suriname </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                           Peru                         Brazil </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                       Paraguay                          Chile </span></span>
<span><span class="co">#&gt;                              3                              3 </span></span>
<span><span class="co">#&gt;                      Argentina                 United Kingdom </span></span>
<span><span class="co">#&gt;                              3                              4 </span></span>
<span><span class="co">#&gt;                    Netherlands                        Belgium </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                     Luxembourg                         France </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                          Spain                       Portugal </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                        Germany        German Federal Republic </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                         Poland                        Hungary </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                 Czech Republic                          Italy </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                         Greece                         Norway </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                        Denmark                        Iceland </span></span>
<span><span class="co">#&gt;                              4                              4 </span></span>
<span><span class="co">#&gt;                        Bavaria     German Democratic Republic </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                          Baden                   Wuerttemburg </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                Austria-Hungary                        Austria </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                 Czechoslovakia                       Slovakia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                          Malta                        Albania </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Croatia                     Yugoslavia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;         Bosnia and Herzegovina                         Cyprus </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                       Bulgaria                        Moldova </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Romania                         Russia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Estonia                         Latvia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                      Lithuania                        Ukraine </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Belarus                        Armenia </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Georgia                     Azerbaijan </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                        Finland                         Sweden </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                     Cape Verde          Sao Tome and Principe </span></span>
<span><span class="co">#&gt;                              5                              5 </span></span>
<span><span class="co">#&gt;                  Guinea-Bissau </span></span>
<span><span class="co">#&gt;                              5</span></span>
<span><span class="fu">aricode</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/aricode/man/ARI.html" class="external-link">ARI</a></span><span class="op">(</span><span class="va">clust_country_indep</span>, <span class="va">clust_country_dep</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.8886699</span></span></code></pre></div>
<p>On top of the clustering comparison, we can compare the ICL criterion
to see which of the dependent or independent models is a best fit:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MultiplexFitdep</span><span class="op">$</span><span class="va">ICL</span></span>
<span><span class="co">#&gt; [1] -1470.276</span></span>
<span><span class="va">MultiplexFitIndep</span><span class="op">$</span><span class="va">ICL</span></span>
<span><span class="co">#&gt; [1] -1434.602</span></span></code></pre></div>
<p>We can do the same plots for the reorganized matrices and the
corresponding expectations. Note that the expectations correspond to the
marginal expectation of each layer and it may be relevant to have a look
at the conditional expectations.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MultiplexFitdep</span><span class="op">)</span></span></code></pre></div>
<p><img src="Multiplex_allianceNwar_case_study_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">MultiplexFitdep</span>, type <span class="op">=</span> <span class="st">"expected"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in self$predict(): provided expectations are the marginal expectations</span></span>
<span><span class="co">#&gt; in the dependent case</span></span></code></pre></div>
<p><img src="Multiplex_allianceNwar_case_study_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<p>For instance, we may want to compare the marginal distribution for
two countries in their given blocks to have being at war while they are
allied at some point (before or after):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p11</span> <span class="op">&lt;-</span> <span class="va">MultiplexFitdep</span><span class="op">$</span><span class="va">connectParam</span><span class="op">$</span><span class="va">prob11</span></span>
<span><span class="va">p01</span> <span class="op">&lt;-</span> <span class="va">MultiplexFitdep</span><span class="op">$</span><span class="va">connectParam</span><span class="op">$</span><span class="va">prob01</span></span>
<span><span class="va">p10</span> <span class="op">&lt;-</span> <span class="va">MultiplexFitdep</span><span class="op">$</span><span class="va">connectParam</span><span class="op">$</span><span class="va">prob10</span></span>
<span><span class="co"># conditional probabilities of being at war while having been or will</span></span>
<span><span class="co"># be allied</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p11</span><span class="op">/</span><span class="op">(</span><span class="va">p11</span> <span class="op">+</span> <span class="va">p10</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.09 0.10 0.03 0.43</span></span>
<span><span class="co">#&gt; [2,] 0.10 0.11 0.09 0.14</span></span>
<span><span class="co">#&gt; [3,] 0.03 0.09 0.05 0.03</span></span>
<span><span class="co">#&gt; [4,] 0.43 0.14 0.03 0.01</span></span>
<span><span class="co"># marginal probabilities of being at war</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">p11</span> <span class="op">+</span> <span class="va">p01</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,] 0.07 0.04 0.03 0.14</span></span>
<span><span class="co">#&gt; [2,] 0.04 0.10 0.04 0.13</span></span>
<span><span class="co">#&gt; [3,] 0.03 0.04 0.05 0.03</span></span>
<span><span class="co">#&gt; [4,] 0.14 0.13 0.03 0.02</span></span></code></pre></div>
<div class="section level3">
<h3 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-gibler2008international" class="csl-entry">
Gibler, Douglas M. 2008. <em>International Military Alliances,
1648-2008</em>. CQ Press.
</div>
<div id="ref-sarkees2010resort" class="csl-entry">
Sarkees, Meredith Reid, and Frank Whelon Wayman. 2010. <em>Resort to
War: A Data Guide to Inter-State, Extra-State, Intra-State, and
Non-State Wars, 1816-2007</em>. Cq Pr.
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Julien Chiquet, Sophie Donnet, Pierre Barbillon.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
